# M7: Analyze Documentation Sample Patterns

**Priority:** Medium
**Effort:** Low
**Status:** Not Started
**Created:** 2026-01-02

## Overview

During the documentation samples migration, several framework behaviors were discovered that may indicate API design issues or documentation gaps. Each pattern should be analyzed to determine if it represents expected behavior, a bug, or a design issue requiring changes.

## Patterns to Analyze

### 1. PauseAllActions() Not on Interface

**Observed:** `PauseAllActions()` is only available on concrete `ValidateBase<T>`, not on `IValidateBase`.

**Current Workaround:** Documentation samples use internal classes with concrete types.

**Questions:**
- Should `PauseAllActions()` be exposed on the interface?
- Is this intentional to prevent misuse from outside the domain layer?
- Should there be an `IPausable` interface?

**Location:** `src/Neatoo/ValidateBase.cs`

---

### 2. Parent Points to Aggregate Root, Not Containing List

**Observed:** When an entity is in a list, `entity.Parent` points to the aggregate root entity, not the `EntityListBase` that contains it.

**Current Workaround:** Removed cross-item validation rule that checked `target.Parent is IContactPhoneList`.

**Questions:**
- Is this the intended design? (Likely yes for DDD aggregate root pattern)
- How should cross-item validation access sibling items?
- Should documentation clarify this behavior explicitly?
- Is there a `List` or `ContainingList` property that provides access to the list?

**Location:** `src/Neatoo/EntityListBase.cs` - `SetParent()` method

---

### 3. [Required] Allows Empty String on Nullable Properties

**Observed:** `[Required]` attribute on `string?` properties validates null but allows empty string `""`.

**Current Workaround:** Tests use null values, not empty strings, for Required validation.

**Questions:**
- Is this standard .NET DataAnnotations behavior? (Yes, `AllowEmptyStrings = true` by default)
- Should Neatoo override this default?
- Should documentation mention this explicitly?
- Consider adding `[Required(AllowEmptyStrings = false)]` examples to docs.

**Location:** Standard .NET behavior, but affects all Neatoo validation

---

### 4. MapModifiedTo Generation Requirements

**Observed:** `MapModifiedTo` is generated by Neatoo.BaseGenerator when declared as `public partial void MapModifiedTo(EntityType entity);`

**Current Status:** Working correctly, but documentation may be unclear about requirements.

**Questions:**
- Is the partial method signature documented clearly?
- Are the matching rules (property names, types) documented?
- Should there be compile-time diagnostics for mismatched properties?

**Location:** `src/Neatoo.BaseGenerator/BaseGenerator.cs` - `AddMapModifiedToMethod()`

---

## Action Items

1. [ ] Investigate each pattern and document findings
2. [ ] Determine if any represent bugs vs. intentional design
3. [ ] Update documentation for intentional behaviors
4. [ ] Create separate todos for any bugs or design changes needed
5. [ ] Update CLAUDE.md "Key Patterns Discovered" with clarifications

## Related Files

- `CLAUDE.md` - Key Patterns Discovered table
- `src/Neatoo.Documentation.Samples/` - Sample code demonstrating patterns
- `docs/property-system.md` - PauseAllActions documentation
- `docs/collections.md` - Parent/list relationship documentation
- `docs/validation-and-rules.md` - Required attribute documentation
- `docs/mapper-methods.md` - MapModifiedTo documentation
